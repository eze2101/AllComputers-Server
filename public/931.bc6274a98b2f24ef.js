"use strict";(self.webpackChunkMercado=self.webpackChunkMercado||[]).push([[931],{3931:(Q,x,a)=>{a.r(x),a.d(x,{AdminModule:()=>j});var g=a(9808),u=a(1083),y=a(3218),P=a(8325),A=a(8512),t=a(5e3),T=a(1170);let F=(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-home"]],decls:2,vars:0,template:function(e,i){1&e&&t._UZ(0,"app-menu")(1,"router-outlet")},directives:[T.M,u.lC],styles:[""]}),o})(),U=(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-home-categoria"]],decls:1,vars:0,template:function(e,i){1&e&&t._UZ(0,"router-outlet")},directives:[u.lC],styles:[""]}),o})();var n=a(3075),E=a(5226),s=a.n(E),b=a(9097),m=a(7093),_=a(4834),p=a(4106),v=a(7531),Z=a(7423);function M(o,c){if(1&o&&t._UZ(0,"img",13),2&o){const e=t.oxw();t.s9C("src",e.image,t.LSH)}}function O(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"div",14)(1,"button",15),t.NdJ("click",function(){return t.CHM(e),t.oxw().cancelar()}),t._uU(2," Cancelar "),t.qZA(),t.TgZ(3,"button",16),t.NdJ("click",function(){return t.CHM(e),t.oxw().CrearCategoria()}),t._uU(4," Crear "),t.qZA()()}}function I(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"div",14)(1,"button",17),t.NdJ("click",function(){return t.CHM(e),t.oxw().cancelar()}),t._uU(2," Cancelar "),t.qZA(),t.TgZ(3,"button",18),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return r.eliminar(r.categoria._id)}),t._uU(4," Eliminar"),t.qZA(),t.TgZ(5,"button",19),t.NdJ("click",function(){return t.CHM(e),t.oxw().editarCategoria()}),t._uU(6," Guardar "),t.qZA()()}}let k=(()=>{class o{constructor(e,i,r,l){this.productoService=e,this.activeRoute=i,this.fb=r,this.router=l,this.miFormulario=this.fb.group({name:["",[n.kI.required,n.kI.minLength(4)]],img:["",[n.kI.required]],file:[null]}),this.titulo="Crear Categoria",this.path=this.activeRoute.snapshot.paramMap.get("name"),console.log(this.path),this.router.routeReuseStrategy.shouldReuseRoute=function(){return!1}}ngOnInit(){this.Editar()}CrearCategoria(){const{name:e,img:i}=this.miFormulario.value,r={name:e,img:i};console.log(r),this.productoService.crearCategoria(r).subscribe(l=>{!0===l?(this.subir(),s().fire({icon:"success",title:"Categoria creada",timer:1500}),this.router.navigateByUrl("/admin")):s().fire({icon:"error",title:"Oops...",text:l})})}esEditar(){return"new"!==this.path}Editar(){this.esEditar()&&(this.titulo="Editar Categoria",this.productoService.getCategoriasSugeridas(this.path).subscribe(e=>{this.categoria=e[0],this.id=this.categoria._id,this.buscarImagen(),this.miFormulario.setValue({name:e[0].name,img:e[0].img,file:null}),console.log(this.miFormulario.value)}))}buscarImagen(){this.productoService.getImagen(this.categoria.img).subscribe(e=>{this.image=e.fileUrl,this.imagen=e,console.log(this.imagen)})}editarCategoria(){const{name:e,img:i}=this.miFormulario.value;this.productoService.editarCategoria(this.id,{name:e,img:i}).subscribe(l=>{console.log(l),!0===l.ok?(this.subir(),s().fire({icon:"success",title:`Categoria ${e} actualizada!`,timer:1500}),this.router.navigateByUrl("/admin")):s().fire({icon:"error",title:"Oops...",text:l.msg})},l=>{console.log(l),s().fire({icon:"error",title:"Oops...",text:l.error.msg})})}cancelar(){this.router.navigateByUrl("/admin")}eliminar(e){s().fire({title:`seguro de eliminar "${this.categoria.name}"`,text:"No se puede revertir esta acci\xf3n",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar!"}).then(i=>{i.isConfirmed&&(this.productoService.eliminarCategoria(e).subscribe(r=>{}),s().fire({title:"Eliminada!",text:"Categoria eliminada correctamente.",icon:"success",timer:2e3})),this.router.navigateByUrl("/admin")})}subir(){const e=this.miFormulario;console.log(this.miFormulario.value.file),e.value.file?(this.productoService.uploadImagenes(e.value.img,this.file).subscribe(i=>{}),this.image="../assets/mazo.jpg"):console.log("no entro")}onFileChange(e){if(e.target.files&&e.target.files.length>0){const i=e.target.files[0];if(i.type.includes("image")){const r=new FileReader;r.readAsDataURL(i),r.onload=function(){this.image=r.result}.bind(this),this.file=i}else console.log("hubo un error")}}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(b.k),t.Y36(u.gz),t.Y36(n.qu),t.Y36(u.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-crear-editar-categoria"]],decls:26,vars:5,consts:[["fxLayoutAlign","center center"],["fxLayout","column","fxFlex","80",1,"container"],[1,"titulo"],["autocomplete","off","fxLayout","row","fxLayout.xs","column",3,"formGroup"],["fxFlex","100","fxLayout","column",1,"nombres"],["appearance","fill"],["matInput","","formControlName","name","placeholder","Nombre de la categoria"],["matInput","","placeholder","Nombre","formControlName","img"],["fxLayout","column","fxLayoutAlign","center center","fxFlex","100"],[1,"archivo"],["type","file","placeholder","imagen","formControlName","file",1,"archivo",3,"change"],["alt","",3,"src",4,"ngIf"],["class","botones",4,"ngIf"],["alt","",3,"src"],[1,"botones"],["mat-button","","fxFlex","30",1,"boton","cancelar",3,"click"],["mat-button","","fxFlex","30",1,"boton","crear",3,"click"],["mat-button","","fxFlex","20",1,"boton","cancelar",3,"click"],["mat-button","","fxFlex","20",1,"boton","eliminar",3,"click"],["mat-button","","fxFlex","20",1,"boton","crear",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),t._uU(4),t.qZA()(),t._UZ(5,"mat-divider"),t.TgZ(6,"form",3)(7,"div",4)(8,"mat-label"),t._uU(9,"Nombre:"),t.qZA(),t.TgZ(10,"mat-form-field",5),t._UZ(11,"input",6),t.qZA(),t.TgZ(12,"mat-label"),t._uU(13,"Ingrese un nombre \xfanico para la imagen:"),t.qZA(),t.TgZ(14,"mat-form-field",5),t._UZ(15,"input",7),t.qZA(),t.TgZ(16,"span"),t._uU(17," *(si quiere usar una imagen ya existente, coloque el nombre asignado) "),t.qZA()(),t.TgZ(18,"div",8)(19,"label",9)(20,"input",10),t.NdJ("change",function(l){return i.onFileChange(l)}),t.qZA(),t._uU(21,"Seleccionar Imagen "),t.qZA(),t.YNc(22,M,1,1,"img",11),t.qZA()(),t._UZ(23,"mat-divider"),t.YNc(24,O,5,0,"div",12),t.YNc(25,I,7,0,"div",12),t.qZA()()),2&e&&(t.xp6(4),t.Oqu(i.titulo),t.xp6(2),t.Q6J("formGroup",i.miFormulario),t.xp6(16),t.Q6J("ngIf",i.image),t.xp6(2),t.Q6J("ngIf",!i.esEditar()),t.xp6(1),t.Q6J("ngIf",i.esEditar()))},directives:[m.Wh,m.xw,m.yH,_.d,n._Y,n.JL,n.sg,p.hX,p.KE,v.Nt,n.Fj,n.JJ,n.u,g.O5,Z.lW],styles:[".container[_ngcontent-%COMP%]{background-color:#fff;margin-top:15px;border-radius:15px}.titulo[_ngcontent-%COMP%]{display:flex;justify-content:center}.nombres[_ngcontent-%COMP%]{align-items:flex-start;padding-top:15px;padding-left:30px}input[type=file i][_ngcontent-%COMP%]{display:none}.archivo[_ngcontent-%COMP%]{border:1px solid #ccc;display:inline-block;padding:6px 12px;cursor:pointer;margin:20px 0}.botones[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.boton[_ngcontent-%COMP%]{background-color:#f2ebeb}.cancelar[_ngcontent-%COMP%]:hover{background-color:#bfb4b4}.crear[_ngcontent-%COMP%]:hover{background-color:#673ab7e3}.eliminar[_ngcontent-%COMP%]:hover{background-color:#c00000}form[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:stretch}img[_ngcontent-%COMP%]{width:95%;height:auto;max-height:400px;margin-bottom:10px}mat-label[_ngcontent-%COMP%]{margin-bottom:5px;font-size:25px;font-weight:700}span[_ngcontent-%COMP%]{margin-bottom:20px;font-size:17px;font-weight:700}label[_ngcontent-%COMP%]{font-weight:700}"]}),o})();var N=a(4107),q=a(508);function J(o,c){if(1&o&&(t.TgZ(0,"mat-option",20),t._uU(1),t.qZA()),2&o){const e=c.$implicit;t.s9C("value",e.name),t.xp6(1),t.Oqu(e.name)}}function S(o,c){if(1&o&&t._UZ(0,"img",21),2&o){const e=t.oxw();t.s9C("src",e.image,t.LSH)}}function L(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"div",22)(1,"button",23),t.NdJ("click",function(){return t.CHM(e),t.oxw().cancelar()}),t._uU(2," Cancelar "),t.qZA(),t.TgZ(3,"button",24),t.NdJ("click",function(){return t.CHM(e),t.oxw().CrearProducto()}),t._uU(4," Crear "),t.qZA()()}}function w(o,c){if(1&o){const e=t.EpF();t.TgZ(0,"div",22)(1,"button",25),t.NdJ("click",function(){return t.CHM(e),t.oxw().cancelar()}),t._uU(2," Cancelar "),t.qZA(),t.TgZ(3,"button",26),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return r.eliminar(r.producto._id)}),t._uU(4," Eliminar "),t.qZA(),t.TgZ(5,"button",27),t.NdJ("click",function(){return t.CHM(e),t.oxw().editarProducto()}),t._uU(6," Guardar "),t.qZA()()}}const H=[{path:"",component:F,children:[{path:"crear-editar-categoria/:name",component:k},{path:"crear-editar-producto/:name",component:(()=>{class o{constructor(e,i,r,l){this.productoService=e,this.activeRoute=i,this.fb=r,this.router=l,this.miFormulario=this.fb.group({name:["perros",[n.kI.required,n.kI.minLength(4)]],price:[15,[n.kI.required]],stock:[20,[n.kI.required]],description:["asdasdasdas",[n.kI.required,n.kI.minLength(4)]],categoria:["teclados",[n.kI.required,n.kI.minLength(4)]],img:["",[n.kI.required]],file:null}),this.titulo="Crear Producto",this.path=this.activeRoute.snapshot.paramMap.get("name"),console.log(this.path),this.router.routeReuseStrategy.shouldReuseRoute=function(){return!1}}ngOnInit(){this.Editar(),this.productoService.getCategorias().subscribe(e=>{this.categorias=e})}CrearProducto(){const{name:e,price:i,stock:r,description:l,categoria:h,img:C}=this.miFormulario.value,f={name:e,price:i,stock:r,description:l,categoria:h,img:C};console.log(f),this.productoService.crearProducto(f).subscribe(d=>{!0===d?(this.subir(),s().fire({icon:"success",title:"Producto creado",timer:1500}),this.router.navigateByUrl("/admin")):s().fire({icon:"error",title:"Oops...",text:d})})}esEditar(){return"new"!==this.path}Editar(){this.esEditar()&&(this.titulo="Editar Producto",this.productoService.getProductosSugeridos(this.path).subscribe(e=>{this.producto=e[0],this.id=this.producto._id,this.buscarImagen(),this.miFormulario.setValue({name:e[0].name,price:e[0].price,stock:e[0].stock,description:e[0].description,categoria:e[0].categoria,img:e[0].img,file:null})}))}buscarImagen(){this.productoService.getImagen(this.producto.img).subscribe(e=>{this.image=e.fileUrl,this.imagen=e,console.log(this.imagen)})}editarProducto(){const{name:e,price:i,stock:r,description:l,categoria:h,img:C}=this.miFormulario.value,f={name:e,price:i,stock:r,description:l,categoria:h,img:C};console.log(this.producto),console.log(this.id),this.productoService.editarProducto(this.id,f).subscribe(d=>{!0===d.ok?(this.subir(),s().fire({icon:"success",title:`Producto ${e} actualizado!`,timer:1500}),this.router.navigateByUrl("/admin")):s().fire({icon:"error",title:"Oops...",text:d.msg})})}cancelar(){this.router.navigateByUrl("/admin")}eliminar(e){s().fire({title:`seguro de eliminar "${this.producto.name}"`,text:"No se puede revertir esta acci\xf3n",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar!"}).then(i=>{i.isConfirmed&&(this.productoService.eliminarProducto(e).subscribe(r=>r),s().fire({title:"Eliminada!",text:"Producto eliminado correctamente.",icon:"success",timer:2e3})),this.router.navigateByUrl("/admin")})}subir(){const e=this.miFormulario;console.log(this.miFormulario.value.file),e.value.file?(this.productoService.uploadImagenes(e.value.img,this.file).subscribe(i=>{}),this.image="../assets/mazo.jpg"):console.log("no entro")}onFileChange(e){if(e.target.files&&e.target.files.length>0){const i=e.target.files[0];if(i.type.includes("image")){const r=new FileReader;r.readAsDataURL(i),r.onload=function(){this.image=r.result}.bind(this),this.file=i}else console.log("hubo un error")}}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(b.k),t.Y36(u.gz),t.Y36(n.qu),t.Y36(u.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-crear-editar-producto"]],decls:43,vars:6,consts:[["fxLayoutAlign","center center"],["fxLayout","column","fxFlex","80",1,"container"],[1,"titulo"],["autocomplete","off","fxLayout","row wraps","fxLayout.xs","column",3,"formGroup"],["fxFlex","50","fxLayout","column",1,"nombres"],["appearance","fill"],["matInput","","formControlName","name","placeholder","Nombre del Producto"],["matInput","","formControlName","price","placeholder","precio"],["matInput","","formControlName","stock","placeholder","unidades disponibles"],["formControlName","categoria"],[3,"value",4,"ngFor","ngForOf"],["fxLayout","column","fxLayoutAlign","flex-start center","fxFlex","50"],[1,"archivo"],["type","file","placeholder","imagen","formControlName","file",3,"change"],["alt","",3,"src",4,"ngIf"],["matInput","","type","text","placeholder","Nombre","formControlName","img"],["fxFlex","100","fxLayout","column",1,"description"],["appearance","fill",1,"descripcion"],["matInput","","type","text","formControlName","description","placeholder","descripcion"],["class","botones",4,"ngIf"],[3,"value"],["alt","",3,"src"],[1,"botones"],["mat-button","","fxFlex","30",1,"boton","cancelar",3,"click"],["mat-button","","fxFlex","30",1,"boton","crear",3,"click"],["mat-button","","fxFlex","20",1,"boton","cancelar",3,"click"],["mat-button","","fxFlex","20",1,"boton","eliminar",3,"click"],["mat-button","","fxFlex","20",1,"boton","crear",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),t._uU(4),t.qZA()(),t._UZ(5,"mat-divider"),t.TgZ(6,"form",3)(7,"div",4)(8,"mat-label"),t._uU(9,"Nombre:"),t.qZA(),t.TgZ(10,"mat-form-field",5),t._UZ(11,"input",6),t.qZA(),t.TgZ(12,"mat-label"),t._uU(13,"Precio:"),t.qZA(),t.TgZ(14,"mat-form-field",5),t._UZ(15,"input",7),t.qZA(),t.TgZ(16,"mat-label"),t._uU(17,"Unidades disponibles:"),t.qZA(),t.TgZ(18,"mat-form-field",5),t._UZ(19,"input",8),t.qZA(),t.TgZ(20,"mat-label"),t._uU(21,"Categoria:"),t.qZA(),t.TgZ(22,"mat-form-field",5)(23,"mat-select",9),t.YNc(24,J,2,2,"mat-option",10),t.qZA()()(),t.TgZ(25,"div",11)(26,"label",12)(27,"input",13),t.NdJ("change",function(l){return i.onFileChange(l)}),t.qZA(),t._uU(28,"Seleccionar Imagen "),t.qZA(),t.YNc(29,S,1,1,"img",14),t.TgZ(30,"mat-label"),t._uU(31,"Ingrese un nombre \xfanico para la imagen:"),t.qZA(),t.TgZ(32,"mat-form-field",5),t._UZ(33,"input",15),t.qZA(),t.TgZ(34,"span"),t._uU(35," *(si quiere usar una imagen ya existente, coloque el nombre asignado) "),t.qZA()(),t.TgZ(36,"div",16)(37,"mat-label"),t._uU(38,"Descripci\xf3n"),t.qZA(),t.TgZ(39,"mat-form-field",17),t._UZ(40,"textarea",18),t.qZA()()(),t.YNc(41,L,5,0,"div",19),t.YNc(42,w,7,0,"div",19),t.qZA()()),2&e&&(t.xp6(4),t.Oqu(i.titulo),t.xp6(2),t.Q6J("formGroup",i.miFormulario),t.xp6(18),t.Q6J("ngForOf",i.categorias),t.xp6(5),t.Q6J("ngIf",i.image),t.xp6(12),t.Q6J("ngIf",!i.esEditar()),t.xp6(1),t.Q6J("ngIf",i.esEditar()))},directives:[m.Wh,m.xw,m.yH,_.d,n._Y,n.JL,n.sg,p.hX,p.KE,v.Nt,n.Fj,n.JJ,n.u,N.gD,g.sg,q.ey,g.O5,Z.lW],styles:[".container[_ngcontent-%COMP%]{background-color:#fff;margin-top:15px;border-radius:15px}.titulo[_ngcontent-%COMP%]{display:flex;justify-content:center}.nombres[_ngcontent-%COMP%]{align-items:flex-start;padding-top:15px;padding-left:30px}input[type=file i][_ngcontent-%COMP%]{display:none}.archivo[_ngcontent-%COMP%]{border:1px solid #ccc;display:inline-block;padding:6px 12px;cursor:pointer;margin:20px 0}.botones[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.boton[_ngcontent-%COMP%]{background-color:#f2ebeb}.cancelar[_ngcontent-%COMP%]:hover{background-color:#bfb4b4}.crear[_ngcontent-%COMP%]:hover{background-color:#673ab7e3}.eliminar[_ngcontent-%COMP%]:hover{background-color:#c00000}.description[_ngcontent-%COMP%]{padding:15px}.descripcion[_ngcontent-%COMP%]{width:100%!important}form[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:stretch}img[_ngcontent-%COMP%]{width:95%;height:auto;max-height:400px;margin-bottom:10px}mat-label[_ngcontent-%COMP%]{margin-bottom:5px;font-size:25px;font-weight:700}span[_ngcontent-%COMP%]{margin-bottom:20px;font-size:17px;font-weight:700}label[_ngcontent-%COMP%]{font-weight:700}"]}),o})()},{path:":name",component:U,children:[{path:"",component:y.n},{path:":name",component:P.g}]},{path:"",component:A.p}]}];let R=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[u.Bz.forChild(H)],u.Bz]}),o})();var B=a(9258),Y=a(6234),z=a(9764);let j=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[g.ez,R,Y.q,n.UX,z.o9,B.K]]}),o})()}}]);